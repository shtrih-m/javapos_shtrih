package com.shtrih.fiscalprinter.scoc.commands;

import org.junit.Test;

import static com.shtrih.fiscalprinter.ByteUtils.byteArray;
import static org.junit.Assert.assertArrayEquals;
import static org.junit.Assert.assertEquals;

public class DeviceFirmwareResponseTests {

    @Test
    public void Should_read_from_input_stream() throws Exception {
        byte[] data = byteArray(
                0xA5, 0x1F, 0x13, 0x00, 0x15, 0x20, 0x01, 0x00, 0x00, 0x17,
                0x20, 0x02, 0x00, 0x08, 0x00, 0x08, 0x20, 0x04, 0x00, 0x01,
                0x00, 0x00, 0x00,
                0xA7, 0x1F, 0x49, 0x00, 0x00, 0x20, 0x04,
                0x00, 0x01, 0x00, 0x00, 0x00, 0x58, 0x1B, 0x04, 0x00, 0x30,
                0x72, 0x32, 0x5B, 0x1B, 0x20, 0x04, 0x00, 0xF0, 0x86, 0x01,
                0x00, 0x1D, 0x20, 0x01, 0x00, 0xAA, 0x1C, 0x20, 0x01, 0x00,
                0x01, 0x1E, 0x20, 0x23, 0x00, 0xA4, 0xE4, 0x17, 0x8A, 0x51,
                0x9F, 0x20, 0x39, 0x52, 0xA4, 0xCD, 0x2B, 0x0B, 0xBA, 0xF7,
                0xB1, 0x57, 0xD2, 0x9D, 0x2E, 0x48, 0x10, 0x6F, 0xE2, 0xDA,
                0x50, 0x0B, 0x36, 0xB9, 0x8C, 0x6E, 0x2B, 0x67, 0xB0, 0xE5);

        DeviceFirmwareResponse cmd = DeviceFirmwareResponse.read(data);

        assertEquals(1, cmd.getPartNumber());
        assertEquals(170, cmd.getPartsCount());
        assertEquals(100080L, cmd.getFirmwareVersion());
        assertArrayEquals(byteArray(0xA4, 0xE4, 0x17, 0x8A, 0x51,
                0x9F, 0x20, 0x39, 0x52, 0xA4, 0xCD, 0x2B, 0x0B, 0xBA, 0xF7,
                0xB1, 0x57, 0xD2, 0x9D, 0x2E, 0x48, 0x10, 0x6F, 0xE2, 0xDA,
                0x50, 0x0B, 0x36, 0xB9, 0x8C, 0x6E, 0x2B, 0x67, 0xB0, 0xE5), cmd.getData());
    }
}
